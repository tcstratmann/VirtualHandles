<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: server.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: server.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/bin/node

/**
 * MATJES-UI
 * 
 * @file Server-Script
 * @author Uwe Gruenefeld, Tim Claudius Stratmann
 * @version 2016-02-24
 * 
 **/

// create objects
var express = require('express')
,   app = express()
,   server = require('http').createServer(app)
,   io = require('socket.io').listen(server)
,   conf = require('./config.json')
,	model = require('./model.json');

// bind port to server
server.listen(conf.port);

// static files
app.use(express.static('./../'));

// index file
app.get('/', function (req, res) {
	res.sendfile('./../index.html');
});

// data management
io.sockets.on('connection', function (socket) {

	// get of variable
	socket.on('data', function(data) {
	
		if(model.hasOwnProperty(data.name)) {
			
			// new value for variable
			if(data.hasOwnProperty('value')) {
			
				// update model
				model[data.name] = data.value;
				
				// update all sockets
				io.sockets.emit('data', { name : data.name, value : data.value } );
			
			// read value
			} else {
			
				// answer request
				socket.emit('data', { name : data.name, value : model[data.name] } );
			}
			
		} else {
			
			// update model
			model[data.name] = data.value;
		}
	});
});

// status
var os = require('os');
var ifaces = os.networkInterfaces();

Object.keys(ifaces).forEach(function (ifname) {
  var alias = 0;

  ifaces[ifname].forEach(function (iface) {
    if ('IPv4' !== iface.family || iface.internal !== false) {
      // skip over internal (i.e. 127.0.0.1) and non-ipv4 addresses
      return;
    }

    if (alias >= 1) {
      // this single interface has multiple ipv4 addresses
      //console.log(ifname + ':' + alias, iface.address);
	  console.log('The Server is running, access via http://'+iface.address +':'+ conf.port + '/');
    } else {
      // this interface has only one ipv4 adress
      //console.log(ifname, iface.address);
	  console.log('The Server is running, access via http://'+iface.address +':'+conf.port + '/');
    }
    ++alias;
  });
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#showArUcoMarkers">showArUcoMarkers</a></li><li><a href="global.html#showCompass">showCompass</a></li><li><a href="global.html#showEcholot">showEcholot</a></li><li><a href="global.html#showGPS">showGPS</a></li><li><a href="global.html#showHeading">showHeading</a></li><li><a href="global.html#showLightMaster">showLightMaster</a></li><li><a href="global.html#showLightOverview">showLightOverview</a></li><li><a href="global.html#showLightSignalsFront">showLightSignalsFront</a></li><li><a href="global.html#showLightSignalsStb">showLightSignalsStb</a></li><li><a href="global.html#showLog">showLog</a></li><li><a href="global.html#showMachineTelegraph">showMachineTelegraph</a></li><li><a href="global.html#showNavtex">showNavtex</a></li><li><a href="global.html#showRudder">showRudder</a></li><li><a href="global.html#showScale">showScale</a></li><li><a href="global.html#showSliderHorizontal">showSliderHorizontal</a></li><li><a href="global.html#showVHF">showVHF</a></li><li><a href="global.html#socket">socket</a></li><li><a href="global.html#toButton">toButton</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Mon Jul 10 2017 16:14:25 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
